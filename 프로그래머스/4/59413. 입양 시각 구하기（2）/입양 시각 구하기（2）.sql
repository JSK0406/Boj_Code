-- 코드를 입력하세요

WITH RECURSIVE T AS (
    SELECT 0 AS HOURS
    UNION ALL
    SELECT HOURS+1
    FROM T
    WHERE HOURS < 23
)

SELECT B.HOURS AS HOUR
    , COUNT(A.ANIMAL_ID) AS COUNT
FROM ANIMAL_OUTS AS A
    RIGHT JOIN T AS B ON HOUR(A.DATETIME) = B.HOURS
GROUP BY B.HOURS
ORDER BY B.HOURS



















# WITH RECURSIVE T AS (
#     SELECT 0 AS HOURS
#     UNION ALL
#     SELECT HOURS+1 FROM T
#     WHERE HOURS < 23
# )

# SELECT B.HOURS AS HOUR, COUNT(A.ANIMAL_ID) AS COUNT
# FROM ANIMAL_OUTS AS A
#     RIGHT JOIN T AS B ON HOUR(A.DATETIME) = B.HOURS
# GROUP BY B.HOURS
# ORDER BY HOUR

# # SELECT * FROM ANIMAL_OUTS




















# WITH RECURSIVE T AS (
#     SELECT 0 AS HOURS
#     UNION ALL
#     SELECT HOURS+1 FROM T
#     WHERE HOURS < 23
# )

# SELECT A.HOURS AS HOUR, COUNT(B.ANIMAL_ID) AS COUNT
# FROM T AS A
#     LEFT JOIN ANIMAL_OUTS AS B ON A.HOURS = HOUR(B.DATETIME)
# GROUP BY A.HOURS
# ORDER BY A.HOURS

























# WITH RECURSIVE TIME AS (
#     SELECT 0 AS HOURS
#     UNION ALL
#     SELECT HOURS+1 FROM TIME
#     WHERE HOURS < 23
# )

# SELECT TIME.HOURS AS HOUR
# FROM TIME
# LEFT OUTER JOIN ANIMAL_OUTS ON HOUR(ANIMAL_OUTS.DATETIME) = TIME.HOURS